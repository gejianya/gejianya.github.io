{"title":"","uid":"1cd19fc71517798e2fa5b7457d1fb06e","text":"/** * 浏览器识别 * @author houchuanjie */ ;(function(window, document) { var Engine = function() { var name = null; var version = null; }; var Sy...","date":"2022-10-20T22:05:27.368Z","updated":"2022-10-20T22:05:27.368Z","comments":true,"path":"api/pages/shuoshuo/Artitalk/src/plugins/browser.js","covers":null,"excerpt":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script>/**\n * 浏览器识别\n * @author houchuanjie\n */\n;(function(window, document) {\n\tvar Engine = function() {\n\t\tvar name = null;\n\t\tvar version = null;\n\t};\n\n\tvar System = function() {\n\t\tvar name = null;\n\t\tvar version = null;\n\t};\n\n\tvar Browser = function() {\n\t\tvar name = null; //浏览器名称\n\t\tvar version = null; //浏览器版本号\n\t};\n\tvar Client = function() {\n\t\tthis.browser = new Browser(),\n\t\tthis.engine = new Engine(),\n\t\tthis.system = new System(),\n\t\tthis.init();\n\t\tconsole.log(\"Engine ：\" + this.engine.name + \" \" + this.engine.version);\n\t\tconsole.log(\"Browser：\" + this.browser.name + \" \" + this.browser.version);\n\t\tconsole.log(\"System ：\" + this.system.name + \" \" + this.system.version);\n\t\treturn {browser: this.browser, engine: this.engine, system: this.system};\n\t};\n\tClient.prototype = {\n\t\tinit: function(){\n\t\t\tthis.judgeBrowser();\n\t\t\tthis.judgeSystem();\n\t\t},\n\t\tjudgeBrowser: function() {\n\t\t\tvar ua = navigator.userAgent.toString();\n\t\t\tif (/AppleWebKit\\/(\\S+)/.test(ua)) { //匹配Webkit内核浏览器(Chrome、Safari、新Opera、新Konqueror)\n\t\t\t\tthis.engine.name = \"WebKit\";\n\t\t\t\tthis.engine.version = RegExp[\"$1\"];\n\t\t\t\tif (/OPR\\/(\\S+)/.test(ua)) { //确定是不是引用了Webkit内核的Opera\n\t\t\t\t\tthis.browser.name = \"Opera\";\n\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t} else if (/Edge\\/(\\S+)/.test(ua)) {\n\t\t\t\t\tthis.browser.name = \"Edge\";\n\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t} else if (/Chrome\\/(\\S+)/.test(ua)) { //确定是不是Chrome\n\t\t\t\t\tthis.browser.name = \"Chrome\";\n\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t} else if (/konqueror\\/(\\S+)/.test(ua)) { //\n\t\t\t\t\tthis.browser.name = \"Konqueror\";\n\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t} else if (/Safari\\/(\\S+)/.test(ua)) { //确定是不是高版本（3+）的Safari\n\t\t\t\t\tthis.browser.name = \"Safari\";\n\t\t\t\t\tif (/Version\\/(\\S+)/.test(ua)) {\n\t\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t\t} else { //近似地确定低版本Safafi版本号\n\t\t\t\t\t\tvar SafariVersion = 1;\n\t\t\t\t\t\tvar wk = parseFloat(engine.version);\n\t\t\t\t\t\tif (wk < 100) {\n\t\t\t\t\t\t\tSafariVersion = 1;\n\t\t\t\t\t\t} else if (wk < 312) {\n\t\t\t\t\t\t\tSafariVersion = 1.2;\n\t\t\t\t\t\t} else if (wk < 412) {\n\t\t\t\t\t\t\tSafariVersion = 1.3;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tSafariVersion = 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.browser.version = SafariVersion;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (window.opera) { //只匹配拥有Presto内核的老版本Opera 5+(12.15-)\n\t\t\t\tthis.engine.name = \"Presto\";\n\t\t\t\tthis.browser.name = \"Opera\";\n\t\t\t\tthis.engine.version = this.browser.version = window.opera.version();\n\t\t\t} else if (/Opera[\\/\\s](\\S+)/.test(ua)) { //匹配不支持window.opera的Opera 5-或伪装的Opera\n\t\t\t\tthis.engine.name = \"Presto\";\n\t\t\t\tthis.browser.name = \"Opera\";\n\t\t\t\tthis.engine.version = browser.version = RegExp[\"$1\"];\n\t\t\t} else if (/KHTML\\/(\\S+)/.test(ua)) { //KHTML内核\n\t\t\t\tthis.browser.name = \"Konqueror\";\n\t\t\t\tthis.engine.name = \"KHTML\";\n\t\t\t\tthis.engine.version = browser.version = RegExp[\"$1\"];\n\t\t\t} else if (/Konqueror\\/([^;]+)/.test(ua)) { //Konqueror内核\n\t\t\t\tthis.browser.name = \"Konqueror\";\n\t\t\t\tthis.engine.name = \"Konqueror\";\n\t\t\t\tthis.engine.version = browser.version = RegExp[\"$1\"];\n\t\t\t} else if (/rv:([^\\)]+)\\) Gecko\\/\\d{8}/.test(ua)) { //判断是不是基于Gecko内核\n\t\t\t\tthis.engine.name = \"Gecko\";\n\t\t\t\tthis.engine.version = RegExp[\"$1\"];\n\t\t\t\tif (/Firefox\\/(\\S+)/.test(ua)) { //确定是不是Firefox\n\t\t\t\t\tthis.browser.name = \"Firefox\";\n\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t}\n\t\t\t} else if (/Trident\\/([\\d\\.]+)/.test(ua)) { //确定是否是Trident内核的浏览器（IE8+）\n\t\t\t\tthis.engine.name = \"Trident\";\n\t\t\t\tthis.engine.version = RegExp[\"$1\"];\n\t\t\t\tif (/rv\\:([\\d\\.]+)/.test(ua) || /MSIE ([^;]+)/.test(ua)) { //匹配IE8-11+\n\t\t\t\t\tthis.browser.name = \"IE\";\n\t\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t\t}\n\t\t\t} else if (/MSIE ([^;]+)/.test(ua)) { //匹配IE6、IE7\n\t\t\t\tthis.engine.name = \"Trident\";\n\t\t\t\tthis.engine.version = this.browser.version - 4.0; //模拟IE6、IE7中的Trident值\n\t\t\t\tthis.browser.name = \"IE\";\n\t\t\t\tthis.browser.version = RegExp[\"$1\"];\n\t\t\t}\n\t\t},\n\t\tjudgeSystem: function() {\n\t\t\tvar ua = navigator.userAgent.toString();\n\t\t\tvar p = navigator.appVersion; //判断操作系统\n\t\t\tthis.system.name = p.indexOf(\"Win\") != -1 ? \"Windows\" : this.system.name;\n\t\t\tthis.system.name = p.indexOf(\"Mac\") != -1 ? \"Mac\" : this.system.name;\n\t\t\tthis.system.name = p.indexOf(\"like Mac\") != -1 ? \"like Mac\" : this.system.name;\n\t\t\t// Android系统的判断需要在linux后面，因为Android的navigator.appVersion属性里包含Linux\n\t\t\tthis.system.name = p.indexOf(\"Linux\") != -1 ? (p.indexOf(\"Android\") != -1 ? \"Android\" : \"Linux\")\n\t\t\t                : p.indexOf(\"SunOS\") != -1 ? \"Solaris\" \n\t\t\t\t\t\t\t: p.indexOf(\"FreeBSD\") != -1 ? \"FreeBSD\" \n\t\t\t\t\t\t\t: p.indexOf(\"X11\") != -1 ? \"X11\" \n\t\t\t\t\t\t\t: this.system.name;\n\t\t\t// 华为手机里面有linux和Android，所以放在后面，但不是所有华为手机都是HarmonyOS。。。。。所以这个要不要呢？\n\t\t\t// this.system.name = p.indexOf(\"HUAWEI\") != -1 ? \"HarmonyOS\" : this.system.name;\n\n\t\t\tif (this.system.name == \"Windows\") {\n\t\t\t\tif (/Win(?:dows )?([^do]{2})\\s?(\\d+\\.\\d+)?/.test(ua)) {\n\t\t\t\t\tif (RegExp[\"$1\"] == \"NT\") {\n\t\t\t\t\t\tthis.system.version = ({\n\t\t\t\t\t\t\t\"5.0\": \"2000\",\n\t\t\t\t\t\t\t\"5.1\": \"XP\",\n\t\t\t\t\t\t\t\"6.0\": \"Vista\",\n\t\t\t\t\t\t\t\"6.1\": \"7\",\n\t\t\t\t\t\t\t\"6.2\": \"8\",\n\t\t\t\t\t\t\t\"6.3\": \"8.1\",\n\t\t\t\t\t\t\t\"10.0\": \"10\"\n\t\t\t\t\t\t})[RegExp[\"$2\"]] || \"NT \" + RegExp[\"$2\"];\n\t\t\t\t\t} else if (RegExp[\"$1\"] == \"9x\") {\n\t\t\t\t\t\tthis.system.version = \"ME\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.system.version = RegExp[\"$1\"];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\twindow.Client = Client;\n}(window, document))","count_time":{"symbolsCount":"5.2k","symbolsTime":"5 mins."},"toc":""}